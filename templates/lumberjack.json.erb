{
  "network": {
    "servers":         ["<%= @server %>:<%= @port %>"],
    "ssl ca":          "/var/lib/puppet/ssl/certs/ca.pem",
    "ssl key":         "/var/lib/puppet/ssl/private_keys/<%= @fqdn %>.pem",
    "ssl certificate": "/var/lib/puppet/ssl/certs/<%= @fqdn %>.pem"
  },
  "files": [
    {
      "paths": [ "/var/log/dmesg" ],
      "fields": { "type": "dmesg", "program": "kernel" }
    },
    {
      "paths": [
        "/var/log/messages",
        "/var/log/syslog"
      ],
      "fields": { "type": "syslog" }
    },
    {
      "paths": [
        "/var/log/mail.log",
        "/var/log/mail.err"
      ],
      "fields": { "type": "mail", "program": "postfix" }
    },
    {
      "paths": [ "/var/log/nginx/*.log" ],
      "fields": { "type": "nginx", "program": "nginx" }
    },
    {
      "paths": [ "/var/log/puppet/masterhttp.log" ],
      "fields": { "type": "puppet", "program": "puppet-master" }
    },
    {
      "paths": [ "/var/log/puppetdb/puppetdb.log" ],
      "fields": { "type": "puppetdb", "program": "puppetdb" }
    },
  ]
}

